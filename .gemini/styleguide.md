# やることリスト - Gemini Code Assist レビューガイドライン

## プロジェクト概要
日本の生活イベント「引越し」に特化したやることリストを Rails + Inertia.js + React で提供する。非ログインでも閲覧できる SEO 対象ページ（トップ / リスト一覧 / リスト詳細）と、ログイン後の自分用リスト管理が同居する。一次情報：docs/requirements.md、docs/codex-constitution.md、AGENTS.md。

## レビュー基本方針
- コメントは必ず日本語で、根拠→影響→最小修正案→（可能なら）サンプル差分の順で記述する。
- 重大度の高い指摘（正確性、セキュリティ、UX崩れ、SSR/SEO退行）を優先し、スタイルや個人の好みはまとめて提案。
- 同じ論点の蒸し返しや未変更行への重複指摘は禁止。

## UI文言・コピー運用
- docs/requirements.md の表記ルールを前提とし、ユーザー向け UI 文言では曖昧・内部用語的な単語の使用を避ける。
- 特に以下の単語は、**単独での使用を禁止**する。

  - 登録
  - 実行
  - TODO
  - タスク
  - テンプレート

- ただし、要件上・意味上必要な正式表現は例外として許容する。

  - 許容例:
    - 新規登録
    - 会員登録
  - 禁止例:
    - ボタン文言としての「登録」「登録する」

- 単独の「登録」が必要に見える場合は、文脈に応じて以下のように置き換える。
  - 作成
  - 追加
  - 保存
  - 申し込み

- 本ルールの目的は、ユーザーにとって意味が曖昧な操作名を排除し、行動内容が直感的に伝わる UI を維持することである。
- 固定文言（例：`自分用にする`、`やることを追加`、削除確認メッセージ）は変更しない。
- 注意書きは要件定義の文面を改変せずに表示する。

## 言語ルール
- コードコメント・コミットメッセージ・PR テンプレートは日本語（ライブラリ由来の英語コメントを除く）。
- 画面テキストも 40〜60 代ユーザーに伝わる語彙で統一。専門用語は補足する。

## Rails（バックエンド）
- Inertia レスポンスで必要なデータのみを渡す。不要な N+1 を避ける。
- Strong Parameters とモデルバリデーションでユーザー入力を検証する。
- 自分用リストの操作は current_user 限定で認可する。
- Service / Presenter を導入する場合は単一責任を保ち、fat controller を防ぐ。

## React / TypeScript（フロントエンド）
- 画面は関数コンポーネント + Hooks で実装し、Props の型定義を必須とする（`any` 禁止）。
- SSR 対象ページは初期データの null を避け、meta title/description を設定する。
- Loading / Error 状態を明示し、フォーム送信にはエラーハンドリングと disable 制御を入れる。
- UI 表記で禁止ワードを使用しないことを確認する。

## スタイリング・UX
- パステル調のグリーン/イエローを基調にし、余白多め・1画面1目的の原則に従う。
- 「自分用にする」ボタンなど主要な操作は視認性・アクセシビリティ（aria属性、キーボード操作）を確保。
- 削除ダイアログでは、確認文に「このやることを消しますか？」、実行ボタンに「消す」、キャンセルボタンに「そのままにする」という指定文言を使用する。

## SEO / SSR
- トップ / リスト一覧 / リスト詳細の SSR を維持し、meta 情報、OGP を設定。
- Inertia の Head コンポーネント等で title/description を重複なく管理する。

## テスト
- Rails: RSpec 等でモデル・サービスの主要ロジックを検証し、コピー時の初期値（全件未完了）を担保する。
- React: vitest / Testing Library でフォーム入力、状態切り替え、アクセシビリティ属性をテスト。
- テストデータは実際のユースケース（引越しやること）に即した値を使う。

## セキュリティ
- CSRF 対策とセッション認証を尊重し、API を通じてユーザー ID を信頼しない。
- フォーム入力はサーバ側で再検証する。XSS・SQLインジェクションに注意。

## レビュー重点ルール
- UI 文言に禁止ワードを含めず、固定文言と一致させてください。
- 公開リストから自分用リストをコピーする際は、仕様（全件未完了、構成保持）を守ってください。
- SSR 対象ページでは、メタ情報と Inertia SSR の動線を破壊しないでください。
- Rails のコントローラやモデルで、認可漏れや Strong Parameters の漏れがないようにしてください。
- React コンポーネントに、未使用の Props/State や暗黙的な `any` 型を残さないでください。
- エラー状態、ローディング状態、フォームのバリデーション、アクセシビリティ属性を適切に実装してください。
- MVP スコープ外（通知/期日/共有/課金/AI など）の機能が混入しないようにしてください。